<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title></title>
    <script src="htmx.min.js"></script>
    <script>
      htmx.defineExtension("json-enc", {
        onEvent: function (name, evt) {
          if (name === "htmx:configRequest") {
            evt.detail.headers["Content-Type"] = "application/json";
          }
        },

        encodeParameters: function (xhr, parameters, elt) {
          xhr.overrideMimeType("text/json");
          return JSON.stringify(parameters);
        },
      });
    </script>
  </head>
  <body>
    <iframe id="view"></iframe>
    <div>
      <input type="text" id="model" name="model" placeholder="Model..." />
      <div id="chat"></div>
      <input type="text" id="prompt" name="prompt" placeholder="Prompt..." />
      <button
        hx-post="/api/prompt"
        hx-include="#prompt, #model"
        hx-ext="json-enc"
        hx-swap="none"
      >
        Send
      </button>
    </div>
  </body>
</html>
